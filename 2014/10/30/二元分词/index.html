<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xml:lang="zh-cn" lang="zh-cn" >
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.83.1" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>二元分词 &middot; 后会有期</title>
  <meta name="keywords" content="Web开发技术，web开发，数据库相关，PHP相关，golang相关，docker相关，git相关">
  <meta name="description" content="基于Hugo,专注Web开发技术分享,包括数据可视化，前端、数据库、PHP、golang、Elasticsearch等" />
  
  <link type="text/css" rel="stylesheet" href="https://www.johnyn.com/css/style.css?v=2021-05-07%2008%3a15%3a16.348861571%20%2b0000%20UTC%20m%3d%2b0.068607350">
  
  <link rel="shortcut icon" href="/favicon.png">
  
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2398d79e477a3dc3d76badd88dc266eb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
</head>
  <body class="theme-cyan ">
  <aside class="sidebar">
  <div id="fastSearch">
    <input id="searchInput"  placeholder="输入关键词搜索" />
    <ul id="searchResults">
    </ul>
  </div>
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://www.johnyn.com/"><h2>后会有期</h2></a>
      <p class="lead">
       青山不改，绿水长流 carpe diem 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://www.johnyn.com/">主页</a> </li>
        <li class="link"><a target="_blank" href="https://github.com/jangworn/"> Github </a></li>
      </ul>
    </nav>
    <div class="qrcode">
      <img src="/img/qrcode.jpg" alt="">
    </div>
  

  <script src="/js/fuse.min.js"></script> 
  <script src="/js/search.js"></script>
  

   
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>二元分词</h1>
  <time datetime=2014-10-30T10:56:44Z class="post-date">2014-10-30 Thu</time>
  <div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PHP" data-lang="PHP">    <span style="color:#09f;font-style:italic">//Monkey&#39;s 二元分词
</span><span style="color:#09f;font-style:italic"></span>    <span style="color:#069;font-weight:bold">function</span> <span style="color:#c0f">sp_str</span>(<span style="color:#033">$str</span>) {
      <span style="color:#033">$str</span><span style="color:#555">=</span>iconv(<span style="color:#c30">&#34;UTF-8&#34;</span>,<span style="color:#c30">&#34;GBK&#34;</span>,<span style="color:#033">$str</span>);
      <span style="color:#09f;font-style:italic">//所有汉字后添加ASCII的0字符,此法是为了排除特殊中文拆分错误的问题
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#033">$str</span><span style="color:#555">=</span>preg_replace(<span style="color:#c30">&#34;/[</span><span style="color:#c30;font-weight:bold">\x80</span><span style="color:#c30">-</span><span style="color:#c30;font-weight:bold">\xff</span><span style="color:#c30">]{2}/&#34;</span>,<span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\\</span><span style="color:#c30">0&#34;</span><span style="color:#555">.</span>chr(<span style="color:#f60">0x00</span>),<span style="color:#033">$str</span>);
      <span style="color:#09f;font-style:italic">//拆分的分割符
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#033">$search</span> <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">array</span>(<span style="color:#c30">&#34;,&#34;</span>, <span style="color:#c30">&#34;/&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\\</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;.&#34;</span>, <span style="color:#c30">&#34;;&#34;</span>, <span style="color:#c30">&#34;:&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\&#34;</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;!&#34;</span>, <span style="color:#c30">&#34;~&#34;</span>, <span style="color:#c30">&#34;`&#34;</span>, <span style="color:#c30">&#34;^&#34;</span>, <span style="color:#c30">&#34;(&#34;</span>, <span style="color:#c30">&#34;)&#34;</span>, <span style="color:#c30">&#34;?&#34;</span>, <span style="color:#c30">&#34;-&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\t</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;&#39;&#34;</span>, <span style="color:#c30">&#34;&lt;&#34;</span>, <span style="color:#c30">&#34;&gt;&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\r</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;</span><span style="color:#c30;font-weight:bold">\r\n</span><span style="color:#c30">&#34;</span>, <span style="color:#c30">&#34;$&#34;</span>, <span style="color:#c30">&#34;&amp;&#34;</span>, <span style="color:#c30">&#34;%&#34;</span>, <span style="color:#c30">&#34;#&#34;</span>, <span style="color:#c30">&#34;@&#34;</span>, <span style="color:#c30">&#34;+&#34;</span>, <span style="color:#c30">&#34;=&#34;</span>, <span style="color:#c30">&#34;{&#34;</span>, <span style="color:#c30">&#34;}&#34;</span>, <span style="color:#c30">&#34;[&#34;</span>, <span style="color:#c30">&#34;]&#34;</span>, <span style="color:#c30">&#34;：&#34;</span>, <span style="color:#c30">&#34;）&#34;</span>, <span style="color:#c30">&#34;（&#34;</span>, <span style="color:#c30">&#34;．&#34;</span>, <span style="color:#c30">&#34;。&#34;</span>, <span style="color:#c30">&#34;，&#34;</span>, <span style="color:#c30">&#34;！&#34;</span>, <span style="color:#c30">&#34;；&#34;</span>, <span style="color:#c30">&#34;“&#34;</span>, <span style="color:#c30">&#34;”&#34;</span>, <span style="color:#c30">&#34;‘&#34;</span>, <span style="color:#c30">&#34;’&#34;</span>, <span style="color:#c30">&#34;［&#34;</span>, <span style="color:#c30">&#34;］&#34;</span>, <span style="color:#c30">&#34;、&#34;</span>, <span style="color:#c30">&#34;—&#34;</span>, <span style="color:#c30">&#34;　&#34;</span>, <span style="color:#c30">&#34;《&#34;</span>, <span style="color:#c30">&#34;》&#34;</span>, <span style="color:#c30">&#34;－&#34;</span>, <span style="color:#c30">&#34;…&#34;</span>, <span style="color:#c30">&#34;【&#34;</span>, <span style="color:#c30">&#34;】&#34;</span>,);
      <span style="color:#09f;font-style:italic">//替换所有的分割符为空格
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#033">$str</span> <span style="color:#555">=</span> str_replace(<span style="color:#033">$search</span>,<span style="color:#c30">&#39; &#39;</span>,<span style="color:#033">$str</span>);
      <span style="color:#09f;font-style:italic">//用正则匹配半角单个字符或者全角单个字符,存入数组$ar
</span><span style="color:#09f;font-style:italic"></span>      preg_match_all(<span style="color:#c30">&#34;/[</span><span style="color:#c30;font-weight:bold">\x80</span><span style="color:#c30">-</span><span style="color:#c30;font-weight:bold">\xff</span><span style="color:#c30">]?./&#34;</span>,<span style="color:#033">$str</span>,<span style="color:#033">$ar</span>);<span style="color:#033">$ar</span><span style="color:#555">=</span><span style="color:#033">$ar</span>[<span style="color:#f60">0</span>];
      <span style="color:#09f;font-style:italic">//去掉$ar中ASCII为0字符的项目
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#069;font-weight:bold">for</span> (<span style="color:#033">$i</span><span style="color:#555">=</span><span style="color:#f60">0</span>;<span style="color:#033">$i</span><span style="color:#555">&lt;</span>count(<span style="color:#033">$ar</span>);<span style="color:#033">$i</span><span style="color:#555">++</span>) <span style="color:#069;font-weight:bold">if</span> (<span style="color:#033">$ar</span>[<span style="color:#033">$i</span>]<span style="color:#555">!=</span>chr(<span style="color:#f60">0x00</span>) <span style="color:#555">&amp;&amp;</span> trim(<span style="color:#033">$ar</span>[<span style="color:#033">$i</span>])) <span style="color:#033">$ar_new</span>[]<span style="color:#555">=</span><span style="color:#033">$ar</span>[<span style="color:#033">$i</span>];
      <span style="color:#033">$ar</span><span style="color:#555">=</span><span style="color:#033">$ar_new</span>;unset(<span style="color:#033">$ar_new</span>);<span style="color:#033">$oldsw</span><span style="color:#555">=</span><span style="color:#f60">0</span>;
      <span style="color:#09f;font-style:italic">//把连续的半角存成一个数组下标,或者全角的每2个字符存成一个数组的下标
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#069;font-weight:bold">for</span> (<span style="color:#033">$ar_str</span><span style="color:#555">=</span><span style="color:#c30">&#39;&#39;</span>,<span style="color:#033">$i</span><span style="color:#555">=</span><span style="color:#f60">0</span>;<span style="color:#033">$i</span><span style="color:#555">&lt;</span>count(<span style="color:#033">$ar</span>);<span style="color:#033">$i</span><span style="color:#555">++</span>) {

        <span style="color:#033">$sw</span><span style="color:#555">=</span>strlen(<span style="color:#033">$ar</span>[<span style="color:#033">$i</span>]);

        <span style="color:#069;font-weight:bold">if</span> (<span style="color:#033">$i</span><span style="color:#555">&gt;</span><span style="color:#f60">0</span> <span style="color:#069;font-weight:bold">and</span> <span style="color:#033">$sw</span><span style="color:#555">!=</span><span style="color:#033">$oldsw</span>) <span style="color:#033">$ar_str</span><span style="color:#555">.=</span><span style="color:#c30">&#34;&#34;</span>;

        <span style="color:#069;font-weight:bold">if</span> (<span style="color:#033">$sw</span><span style="color:#555">==</span><span style="color:#f60">1</span>) <span style="color:#033">$ar_str</span><span style="color:#555">.=</span><span style="color:#033">$ar</span>[<span style="color:#033">$i</span>];

        <span style="color:#069;font-weight:bold">else</span>

        <span style="color:#069;font-weight:bold">if</span> (strlen(<span style="color:#033">$ar</span>[<span style="color:#033">$i</span><span style="color:#555">+</span><span style="color:#f60">1</span>])<span style="color:#555">==</span><span style="color:#f60">2</span>) <span style="color:#033">$ar_str</span><span style="color:#555">.=</span><span style="color:#c30">&#39;&#34;&#39;</span><span style="color:#555">.</span><span style="color:#033">$ar</span>[<span style="color:#033">$i</span>]<span style="color:#555">.</span><span style="color:#c30">&#34;+&#34;</span><span style="color:#555">.</span><span style="color:#033">$ar</span>[<span style="color:#033">$i</span><span style="color:#555">+</span><span style="color:#f60">1</span>]<span style="color:#555">.</span><span style="color:#c30">&#39;&#34;&#39;</span>;

        <span style="color:#069;font-weight:bold">elseif</span> (<span style="color:#033">$oldsw</span><span style="color:#555">==</span><span style="color:#f60">1</span> <span style="color:#069;font-weight:bold">or</span> <span style="color:#033">$oldsw</span><span style="color:#555">==</span><span style="color:#f60">0</span>) <span style="color:#033">$ar_str</span><span style="color:#555">.=</span><span style="color:#c30">&#34;&#34;</span><span style="color:#555">.</span><span style="color:#033">$ar</span>[<span style="color:#033">$i</span>];

        <span style="color:#033">$oldsw</span><span style="color:#555">=</span><span style="color:#033">$sw</span>;

      }     
      <span style="color:#09f;font-style:italic">//去掉连续的空格
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#033">$ar_str</span><span style="color:#555">=</span>trim(preg_replace(<span style="color:#c30">&#34;# {1,}#i&#34;</span>,<span style="color:#c30">&#34; &#34;</span>,<span style="color:#033">$ar_str</span>));<span style="color:#09f;font-style:italic">//$ar_str = &#34;Monkey s 二元 元分 分词&#34;
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#09f;font-style:italic">//返回拆分后的结果
</span><span style="color:#09f;font-style:italic"></span>      <span style="color:#033">$ar_str</span><span style="color:#555">=</span>iconv(<span style="color:#c30">&#34;GBK&#34;</span>,<span style="color:#c30">&#34;UTF-8&#34;</span>,<span style="color:#033">$ar_str</span>);
      <span style="color:#069;font-weight:bold">return</span> <span style="color:#033">$ar_str</span>;
    }
</code></pre></div>
  <div class="permalink">
    <a class="f-right" href="https://www.johnyn.com/2014/10/09/php-mongo%E6%89%A9%E5%B1%95%E4%BB%A5%E5%8F%8Arockmongo%E5%AE%89%E8%A3%85/">php-mongo扩展以及rockmongo安装&rarr;</a>
    <a class="f-left" href="https://www.johnyn.com/2014/11/07/%E6%8A%8Aghost%E5%8A%A0%E5%85%A5%E5%90%AF%E5%8A%A8%E9%A1%B9/">&larr;把ghost加入启动项</a>
  </div>
</div>



    </main>

    <footer class="footer">
    <p>&copy; 2021. All rights reserved. <a href="https://gohugo.io/" target="_blank">Hugo</a> theme by <a href="https://github.com/jangworn/hugo-theme-ling" target="_blank">ling</a> <a target="_blank" href="https://beian.miit.gov.cn/">粤ICP备2021017283号-1</a></p>
</footer>
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https'){
       bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else{
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    document.write(unescape("%3Cspan class='cnzz_stat' id='cnzz_stat_icon_1279318433'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1279318433%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));
    </script>
  </body>
</html>
